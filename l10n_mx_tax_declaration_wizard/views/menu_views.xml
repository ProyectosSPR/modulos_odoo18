<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Menú Principal (ya existe en el módulo base, solo agregamos items) -->

    <!-- Submenú de Declaraciones -->
    <menuitem
        id="menu_mx_tax_declarations"
        name="Declaraciones"
        parent="l10n_mx_tax_declaration_base.menu_mx_tax_declaration_root"
        sequence="10"/>

    <!-- Item: Todas las Declaraciones -->
    <menuitem
        id="menu_mx_tax_declaration_all"
        name="Todas las Declaraciones"
        parent="menu_mx_tax_declarations"
        action="action_mx_tax_declaration"
        sequence="10"/>

    <!-- Item: Crear Declaración (Wizard) -->
    <menuitem
        id="menu_mx_tax_declaration_wizard"
        name="Crear Declaración (Wizard)"
        parent="menu_mx_tax_declarations"
        action="action_mx_tax_declaration_wizard"
        sequence="20"/>

    <!-- Separador -->
    <menuitem
        id="menu_mx_tax_declarations_separator"
        parent="menu_mx_tax_declarations"
        sequence="30"/>

    <!-- Filtros rápidos por estado -->
    <record id="action_mx_tax_declaration_draft" model="ir.actions.act_window">
        <field name="name">Borradores</field>
        <field name="res_model">mx.tax.declaration</field>
        <field name="view_mode">list,kanban,form</field>
        <field name="context">{'search_default_draft': 1}</field>
        <field name="domain">[('state', '=', 'draft')]</field>
    </record>

    <menuitem
        id="menu_mx_tax_declaration_draft"
        name="Borradores"
        parent="menu_mx_tax_declarations"
        action="action_mx_tax_declaration_draft"
        sequence="31"/>

    <record id="action_mx_tax_declaration_pending" model="ir.actions.act_window">
        <field name="name">Pendientes de Presentar</field>
        <field name="res_model">mx.tax.declaration</field>
        <field name="view_mode">list,kanban,form</field>
        <field name="domain">[('state', 'in', ('calculated', 'reviewed'))]</field>
    </record>

    <menuitem
        id="menu_mx_tax_declaration_pending"
        name="Pendientes de Presentar"
        parent="menu_mx_tax_declarations"
        action="action_mx_tax_declaration_pending"
        sequence="32"/>

    <record id="action_mx_tax_declaration_filed" model="ir.actions.act_window">
        <field name="name">Presentadas</field>
        <field name="res_model">mx.tax.declaration</field>
        <field name="view_mode">list,kanban,form</field>
        <field name="context">{'search_default_filed': 1}</field>
        <field name="domain">[('state', '=', 'filed')]</field>
    </record>

    <menuitem
        id="menu_mx_tax_declaration_filed"
        name="Presentadas"
        parent="menu_mx_tax_declarations"
        action="action_mx_tax_declaration_filed"
        sequence="33"/>

    <record id="action_mx_tax_declaration_overdue" model="ir.actions.act_window">
        <field name="name">Vencidas</field>
        <field name="res_model">mx.tax.declaration</field>
        <field name="view_mode">list,kanban,form</field>
        <field name="context">{'search_default_overdue': 1}</field>
    </record>

    <menuitem
        id="menu_mx_tax_declaration_overdue"
        name="Vencidas"
        parent="menu_mx_tax_declarations"
        action="action_mx_tax_declaration_overdue"
        sequence="34"/>

    <!-- ============================================= -->
    <!-- ACCESOS RÁPIDOS A MÓDULOS RELACIONADOS -->
    <!-- ============================================= -->

    <!-- Acciones locales para XMLs del SAT (filtran ir.attachment por cfdi_type) -->
    <record id="action_mx_tax_sat_emitidos" model="ir.actions.act_window">
        <field name="name">XMLs Emitidos</field>
        <field name="res_model">ir.attachment</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('cfdi_type', 'in', ['I', 'E', 'P', 'N', 'T']), ('cfdi_uuid', '!=', False)]</field>
        <field name="context">{'is_fiel_attachment': True, 'from_sat_sync': True}</field>
    </record>

    <record id="action_mx_tax_sat_recibidos" model="ir.actions.act_window">
        <field name="name">XMLs Recibidos</field>
        <field name="res_model">ir.attachment</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('cfdi_type', 'in', ['SI', 'SE', 'SP', 'SN', 'ST']), ('cfdi_uuid', '!=', False)]</field>
        <field name="context">{'is_fiel_attachment': True, 'from_sat_sync': True}</field>
    </record>

    <record id="action_mx_tax_sat_import" model="ir.actions.act_window">
        <field name="name">Importar XMLs</field>
        <field name="res_model">multi.file.attach.xmls.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="view_id" ref="l10n_mx_sat_sync_itadmin.multi_file_attach_xmls_wizard_form_view"/>
    </record>

    <!-- Submenú: Accesos Rápidos -->
    <menuitem
        id="menu_mx_tax_quick_access"
        name="Accesos Rápidos"
        parent="l10n_mx_tax_declaration_base.menu_mx_tax_declaration_root"
        sequence="80"/>

    <!-- FACTURACIÓN -->
    <menuitem
        id="menu_mx_tax_quick_access_invoicing"
        name="Facturación"
        parent="menu_mx_tax_quick_access"
        sequence="10"/>

    <!-- Facturas de Cliente (usa acción de Odoo account) -->
    <menuitem
        id="menu_mx_tax_quick_customer_invoices"
        name="Facturas de Cliente"
        parent="menu_mx_tax_quick_access_invoicing"
        action="account.action_move_out_invoice_type"
        sequence="10"/>

    <!-- Facturas de Proveedor (usa acción de Odoo account) -->
    <menuitem
        id="menu_mx_tax_quick_vendor_bills"
        name="Facturas de Proveedor"
        parent="menu_mx_tax_quick_access_invoicing"
        action="account.action_move_in_invoice_type"
        sequence="20"/>

    <!-- Facturas para Declarar -->
    <menuitem
        id="menu_mx_tax_quick_invoices_to_declare"
        name="Facturas para Declarar"
        parent="menu_mx_tax_quick_access_invoicing"
        action="l10n_mx_tax_declaration_base.action_account_move_to_declare"
        sequence="30"/>

    <!-- SINCRONIZACIÓN SAT -->
    <menuitem
        id="menu_mx_tax_quick_access_sat_sync"
        name="Sincronización SAT"
        parent="menu_mx_tax_quick_access"
        sequence="20"
        groups="base.group_no_one"/>

    <!-- Importar XMLs del SAT -->
    <menuitem
        id="menu_mx_tax_quick_import_sat"
        name="Importar XMLs del SAT"
        parent="menu_mx_tax_quick_access_sat_sync"
        action="action_mx_tax_sat_import"
        sequence="10"
        groups="base.group_no_one"/>

    <!-- XMLs Emitidos (usa acción local) -->
    <menuitem
        id="menu_mx_tax_quick_sat_emitidos"
        name="XMLs Emitidos"
        parent="menu_mx_tax_quick_access_sat_sync"
        action="action_mx_tax_sat_emitidos"
        sequence="20"
        groups="base.group_no_one"/>

    <!-- XMLs Recibidos (usa acción local) -->
    <menuitem
        id="menu_mx_tax_quick_sat_recibidos"
        name="XMLs Recibidos"
        parent="menu_mx_tax_quick_access_sat_sync"
        action="action_mx_tax_sat_recibidos"
        sequence="30"
        groups="base.group_no_one"/>

    <!-- CONTACTOS -->
    <menuitem
        id="menu_mx_tax_quick_access_contacts"
        name="Contactos"
        parent="menu_mx_tax_quick_access"
        sequence="30"/>

    <!-- Clientes -->
    <menuitem
        id="menu_mx_tax_quick_customers"
        name="Clientes"
        parent="menu_mx_tax_quick_access_contacts"
        action="base.action_partner_customer_form"
        sequence="10"/>

    <!-- Proveedores -->
    <menuitem
        id="menu_mx_tax_quick_vendors"
        name="Proveedores"
        parent="menu_mx_tax_quick_access_contacts"
        action="base.action_partner_supplier_form"
        sequence="20"/>

    <!-- CONCILIACIÓN BANCARIA (OCA) -->
    <menuitem
        id="menu_mx_tax_quick_access_reconcile"
        name="Conciliación Bancaria"
        parent="menu_mx_tax_quick_access"
        sequence="40"/>

    <!-- Conciliar Cuentas (OCA) -->
    <menuitem
        id="menu_mx_tax_quick_account_reconcile"
        name="Conciliar Cuentas"
        parent="menu_mx_tax_quick_access_reconcile"
        action="account_reconcile_oca.account_account_reconcile_act_window"
        sequence="10"/>

    <!-- Extractos Bancarios -->
    <menuitem
        id="menu_mx_tax_quick_bank_statements"
        name="Extractos Bancarios"
        parent="menu_mx_tax_quick_access_reconcile"
        action="account.action_bank_statement_tree"
        sequence="20"/>

    <!-- REPORTES -->
    <menuitem
        id="menu_mx_tax_quick_access_reports"
        name="Reportes Contables"
        parent="menu_mx_tax_quick_access"
        sequence="50"/>

    <!-- Libro Mayor -->
    <menuitem
        id="menu_mx_tax_quick_general_ledger"
        name="Libro Mayor"
        parent="menu_mx_tax_quick_access_reports"
        action="account.action_account_moves_all"
        sequence="10"/>

</odoo>
